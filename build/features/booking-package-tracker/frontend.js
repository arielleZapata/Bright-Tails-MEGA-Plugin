(()=>{"use strict";var e={338(e,o,t){var r=t(795);o.createRoot=r.createRoot,o.hydrateRoot=r.hydrateRoot},795(e){e.exports=window.ReactDOM}},o={};const t=window.React;var r=function t(r){var a=o[r];if(void 0!==a)return a.exports;var s=o[r]={exports:{}};return e[r](s,s.exports,t),s.exports}(338);const a=window.ReactJSXRuntime;function s(e){const{email:o,credits:r,hasPackage:s,calEmail:l}=e,[c,n]=(0,t.useState)(null),[i,d]=(0,t.useState)(!0),[m,u]=(0,t.useState)(null);return(0,t.useEffect)(()=>{o?(async()=>{try{d(!0),u(null);let e=`/wp-json/brighttails/v1/me/last-payment?email=${encodeURIComponent(o)}`;l&&l!==o&&(e+=`&cal_email=${encodeURIComponent(l)}`),console.log("BT Last Payment: Fetching with Stripe email:",o,"Cal.com email:",l||o);const t=await fetch(e),r=await t.json();console.log("BT Last Payment API Response:",r),t.ok?r.found?(n(r),r.debug&&console.log("BT Debug Info:",{"Stripe Email":r.debug.stripe_email,"Cal.com Email":r.debug.cal_email,"Customer ID":r.debug.customer_id,"Customer Name":r.debug.customer_name,"Cal.com API Queried":r.debug.cal_api_queried,"Cal.com API Key Configured":r.debug.cal_api_key_configured,"Cal.com API Error":r.debug.cal_api_error,"Cal.com API Response Code":r.debug.cal_api_response_code,"Cal.com Bookings Count":r.cal_bookings_count})):(n(r),r.debug&&console.log("BT Debug Info (no payment):",r.debug)):n(null)}catch(e){console.error("Booking Tracker: Error fetching last payment",e),u(e.message),n(null)}finally{d(!1)}})():d(!1)},[o,l]),(0,a.jsx)("div",{className:"my-unique-plugin-wrapper-class",children:(0,a.jsx)("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm flex flex-col max-w-[1024px] mx-auto my-4 p-6",children:o?s?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,a.jsx)("h2",{className:"bowlby-one-sc-regular text-2xl mb-6",style:{color:"#000000"},children:"BOOKING PACKAGE"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 md:gap-10 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center gap-2 md:gap-5",children:[(0,a.jsx)("strong",{className:"bowlby-one-sc-regular text-center whitespace-nowrap",style:{color:"#000000",minWidth:"100%"},children:"REMAINING CREDITS"}),(0,a.jsx)("span",{className:"outfit text-center text-3xl font-bold",style:{color:"#000000"},children:r})]}),(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center gap-2 md:gap-5",children:[(0,a.jsx)("strong",{className:"bowlby-one-sc-regular text-center",style:{color:"#000000"},children:"STATUS"}),(0,a.jsx)("span",{className:"outfit text-center",style:{color:"#000000"},children:"Active"})]})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("h2",{className:"bowlby-one-sc-regular text-2xl mb-4",style:{color:"#000000"},children:"WAITING ON PURCHASE"}),(0,a.jsx)("p",{className:"outfit",style:{color:"#000000"},children:"No booking package has been purchased yet. Purchase a package to start booking appointments."})]}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"outfit text-red-600",children:"Error: No email address provided. Please configure the block settings."})})})})}console.log("Booking Tracker: Script loaded"),window.brighttailsBookingTrackerLoaded=!0,document.querySelectorAll(".bt-booking-tracker-update-me").forEach(e=>{try{const o=e.querySelector("pre");if(!o)return void console.warn("Booking Tracker: No pre element found in",e);const t=o.innerText;if(!t)return void console.warn("Booking Tracker: Empty JSON data");const l=JSON.parse(t);r.createRoot(e).render((0,a.jsx)(s,{...l})),e.classList.remove("bt-booking-tracker-update-me"),console.log("Booking Tracker: Component rendered for",l.email)}catch(o){console.error("Booking Tracker: Error initializing component",o,e)}})})();